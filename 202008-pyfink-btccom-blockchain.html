<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>PyFlink 流批一体以及 BTC.com 在区块链领域的专业实践 - 独步清风&#039;s Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="独步清风&#039;s Blog"><meta name="msapplication-TileImage" content="https://dubuqingfeng.oss-cn-hongkong.aliyuncs.com/blog/common/github-icon-url.jpeg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="独步清风&#039;s Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="大家好，我们是 BTC.com 团队。 2020 年，我们有幸接触到了 Flink 和 PyFlink 生态，从团队自身需求出发，完善了团队内实时计算的任务和需求，搭建了流批一体的计算环境。在实现实时计算的过程中，我们在实践中收获了一些经验，在此分享一些这方面的心路历程。"><meta property="og:type" content="blog"><meta property="og:title" content="独步清风"><meta property="og:url" content="https://dbqf.xyz/202008-pyfink-btccom-blockchain.html"><meta property="og:site_name" content="独步清风&#039;s Blog"><meta property="og:description" content="大家好，我们是 BTC.com 团队。 2020 年，我们有幸接触到了 Flink 和 PyFlink 生态，从团队自身需求出发，完善了团队内实时计算的任务和需求，搭建了流批一体的计算环境。在实现实时计算的过程中，我们在实践中收获了一些经验，在此分享一些这方面的心路历程。"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://s1.ax1x.com/2020/09/16/w24yDA.jpg"><meta property="og:image" content="https://s1.ax1x.com/2020/09/16/w24sud.jpg"><meta property="og:image" content="https://s1.ax1x.com/2020/09/16/w245vQ.png"><meta property="og:image" content="https://s1.ax1x.com/2020/09/16/w2oAje.png"><meta property="article:published_time" content="2020-09-08T03:42:00.000Z"><meta property="article:modified_time" content="2020-09-08T03:42:00.000Z"><meta property="article:author" content="admin"><meta property="article:tag" content="btc.com"><meta property="article:tag" content="pyflink"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://s1.ax1x.com/2020/09/16/w24yDA.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://dbqf.xyz/202008-pyfink-btccom-blockchain.html"},"headline":"独步清风's Blog","image":["https://s1.ax1x.com/2020/09/16/w24yDA.jpg","https://s1.ax1x.com/2020/09/16/w24sud.jpg","https://s1.ax1x.com/2020/09/16/w245vQ.png","https://s1.ax1x.com/2020/09/16/w2oAje.png"],"datePublished":"2020-09-08T03:42:00.000Z","dateModified":"2020-09-08T03:42:00.000Z","author":{"@type":"Person","name":"admin"},"description":"大家好，我们是 BTC.com 团队。 2020 年，我们有幸接触到了 Flink 和 PyFlink 生态，从团队自身需求出发，完善了团队内实时计算的任务和需求，搭建了流批一体的计算环境。在实现实时计算的过程中，我们在实践中收获了一些经验，在此分享一些这方面的心路历程。"}</script><link rel="canonical" href="https://dbqf.xyz/202008-pyfink-btccom-blockchain.html"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="独步清风's Blog" type="application/atom+xml">
</head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">独步清风&#039;s Blog</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" target="_blank" rel="noopener" href="https://xiaoye.me">Life</a><a class="navbar-item" target="_blank" rel="noopener" href="https://workflowy.com/s/uKaeJ838dX">Note</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="GitHub" href="https://github.com/dubuqingfeng"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-09-08T03:42:00.000Z" title="9/8/2020, 11:42:00 AM">2020-09-08</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-09-08T03:42:00.000Z" title="9/8/2020, 11:42:00 AM">2020-09-08</time></span><span class="level-item"> admin </span><span class="level-item"><a class="link-muted" href="/categories/flink/">flink</a></span><span class="level-item">36 minutes read (About 5374 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">PyFlink 流批一体以及 BTC.com 在区块链领域的专业实践</h1><div class="content"><h4 id="概要："><a href="#概要：" class="headerlink" title="概要："></a>概要：</h4><p>大家好，我们是 BTC.com 团队。 2020 年，我们有幸接触到了 Flink 和 PyFlink 生态，从团队自身需求出发，完善了团队内实时计算的任务和需求，搭建了流批一体的计算环境。</p>
<p>在实现实时计算的过程中，我们在实践中收获了一些经验，在此分享一些这方面的心路历程。</p>
<h2 id="0x01-TOC"><a href="#0x01-TOC" class="headerlink" title="0x01    TOC"></a>0x01    TOC</h2><ul>
<li>困惑 • 描述 • 思考 • 行动</li>
<li>流批一体的架构<ul>
<li>架构</li>
<li>效果</li>
</ul>
</li>
<li>zeppelin，PyFlink on k8s 等实践<ul>
<li>zeppelin</li>
<li>PyFlink on k8s</li>
</ul>
</li>
<li>区块链领域实践</li>
<li>展望 • 总结</li>
</ul>
<h2 id="0x02-困惑-•-描述-•-思考-•-行动"><a href="#0x02-困惑-•-描述-•-思考-•-行动" class="headerlink" title="0x02    困惑 • 描述 • 思考 • 行动"></a>0x02    困惑 • 描述 • 思考 • 行动</h2><p>作为工程师，我们每天都在不断地了解需求，研发业务。</p>
<p>有一天，我们被拉到了一次团队总结会议上，收到了以下的需求：</p>
<p>销售总监 A：</p>
<p>我们想要知道销售的历史和实时转化率、销售额，能不能统计一下实时的 TOP5 的商品，还有就是大促时候，用户实时访问、商品实时浏览量 TOP5 的情况呢，可以根据他历史访问的记录实时推荐相关的吗。</p>
<p>市场总监 B：</p>
<p>我们想要知道市场推广的效果，每次活动的实时数据，不然我们的市场投放无法准确评估效果，及时反馈啊。</p>
<p>研发总监 C：</p>
<p>有些用户的 bug 无法复现，日志可以再实时一点吗？传统日志分析，需要一定的梳理，可不可以直接清洗 / 处理相关的数据？</p>
<p>采购总监 D：</p>
<p>这些年是不是流行数字化，采购这边想预测采购需求，做一下实时分类和管理支出，预测未来供应来源，完善一下成本。这个有办法做吗？还有有些供应商不太稳定啊，能监控到他们的情况吗？</p>
<p>运维总监 E：</p>
<p>网站有时候访问比较慢，没有地方可以看到实时的机器情况，搞个什么监控大屏，这个有办法解决吗？</p>
<p>部门领导 F：</p>
<p>可以实现上面的人的需求吗。</p>
<p>做以上的了解之后，才发现，大家对于数据需求的渴望程度，使用方不仅需要历史的数据，而且还需要实时性的数据。</p>
<p>在电商、金融、制造等行业，数据有着迅猛的增长，诸多的企业面临着的新的挑战，数据分析的实时处理框架，比如说做一些实时数据分析报表、实时数据处理计算等。</p>
<p>和大多数企业类似，在此之前，我们是没有实时计算这方面的经验和积累的。这时，就开始困惑了，怎样可以更好地做上面的需求，在成本和效果之间取得平衡，如何设计相关的架构。</p>
<p><img src="https://s1.ax1x.com/2020/09/16/w24yDA.jpg" alt="w24yDA.jpg"></p>
<p>穷则思变，在有了困惑以后，我们就开始准备梳理已有的条件和我们到底需要什么。</p>
<p>首先我们的业务范围主要在区块链浏览器与数据服务、区块链矿池、多币种钱包等。在区块链浏览器的业务里，BTC.com 目前已是全球领先的区块链数据服务平台，矿池业务在业内排行第一，区块链浏览器也是全球前三大浏览器之一。</p>
<p>首先，我们通过 parser 解析区块链上的数据，得到各方面的数据信息，可以分析出每个币种的地址活跃度、地址交易情况、交易流向、参与程度等内容。目前，BTC.com 区块链浏览器与行业内各大矿池和交易所等公司都有相关合作，可以更好地实现一些数据的统计、整理、归纳、输出等。</p>
<p>面向的用户，不仅有专业的区块链开发人员，也有各样的 b 端和 c 端用户，c 端用户可以进行区块链地址的标注，智能合约的运行，查看智能合约相关内容等，以及链上数据的检索和查看。b 端用户则有更专业的支持和指导，提供 API、区块链节点等一些的定制以及交易加速、链上的业务合作、数据定制等。</p>
<p>从数据量级来讲，截至目前，比特币大概有 5 亿笔交易，3000 多万地址，22 亿输出（output：每笔交易的输出），并且还在不断增长中。以太坊的话，则更多。而 BTC.com 的矿池和区块链浏览器都支持多币种，各币种的总数据量级约为几十 T。</p>
<p>矿池是矿工购买矿机设备后连接到的服务平台，矿工可以通过连接矿池从而获取更稳定的收益。这是一个需要保证 7 * 24 小时稳定的服务，里面有矿机不断地提交其计算好的矿池下发的任务的解，矿池将达到网络难度的解进行广播。这个过程也可以认为是近乎是实时的，矿机通过提交到服务器，服务器内部再提交到 kafka 消息队列，同时有一些组件监听这些消息进行消费。而这些提交上来的解可以从中分析出矿机的工作状态、算力、连接情况等。</p>
<p>在业务上，我们需要进行历史数据和实时数据的计算。</p>
<p>历史数据要关联一些币价，历史交易信息，而这些交易信息需要一直保存，是一种典型的批处理任务。</p>
<p>每当有新区块的确认，就有一些数据可以得到处理和分析，比如某个地址在这个区块里发生了一笔交易，那么可以从其交易流向去分析是什么样的交易，挖掘交易相关性。或者是在这个区块里有一些特殊的交易，比如 segwit 的交易、比如闪电网络的交易，就是有一些这个币种特有的东西可以进行解析分析和统计。并且在新区块确认时的难度预测也有所变化。</p>
<p>还有就是大额交易的监控，通过新区块的确认和未确认交易，锁定一些大额交易，结合地址的一些标注，锁定交易流向，更好地进行数据分析。</p>
<p>还有是一些区块链方面的 OLAP 方面的需求。</p>
<p><img src="https://s1.ax1x.com/2020/09/16/w24sud.jpg" alt="w24sud.jpg"></p>
<p>总结了在数据统计方面的需求和问题以后，我们就开始进行思考：什么是最合适的架构，如何让人员参与少，成本低。</p>
<p>解决问题，无非就是提出假设，通过度量，然后刷新认知。</p>
<p><img src="https://s1.ax1x.com/2020/09/16/w245vQ.png" alt="w245vQ.png"></p>
<p>在浏览了一些资料以后，我们认为，大部分的计算框架都是通过输入，进行处理，然后得到输出。首先，我们要获取到数据，这里数据可以从 MySQL 也可以从 Kafka，然后进行计算，这里计算可以是聚合，也可以是 TOP 5 类型的，在实时的话，可能还会有窗口类型的。在计算完之后，将结果做下发，下发到消息渠道和存储，发送到微信或者钉钉，落地到 MySQL 等。</p>
<p>团队一开始尝试了 spark，搭建了 yarn，使用了 airflow 作为调度框架，通过做 MySQL 的集成导入，开发了一些批处理任务，有着离线任务的特点，数据固定，量大，计算周期长，需要做一些复杂操作。</p>
<p>在一些批处理任务上，这种架构是稳定的，但是随着业务的发展，有了越来越多的实时的需求，并且实时的数据并不能保证按顺序到达，按时间戳排序，消息的时间字段是允许前后有差距的。在数据模型上，需求驱动式的开发，成本相对来说，spark 的方式对于当时来说较高，对于状态的处理不是很好，导致影响一部分的效率。</p>
<p>其实在 2019 年的时候，就有在调研一些实时计算的事情，关注到了 Flink 框架，当时还是以 java 为主，整体框架概念上和 spark 不同，认为批处理是一种特殊的流，但是因为团队没有 java 方面的基因和沉淀，使用 Flink 作为实时计算的架构，在当时就暂告一个段落。在 2020 年初的时候，不管是<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/kORFyI6Padhb551Gvpp9xQ">阿里云</a>还是 infoq，还是 b 站，都有在推广 PyFlink，而且当时尤其是<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1yt4y127sL">程鹤群</a>和<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1W7411o7Tj">孙金城</a>的视频以及<a target="_blank" rel="noopener" href="https://enjoyment.cool/">孙金城老师的博客</a>的印象深刻。于是就想尝试 PyFlink，其有着流批一体的优势，而且还支持 Python 的一些函数，支持 pandas，甚至以后还可以支持 tensorflow、keras，这对我们的吸引力是巨大的。在之后，就在构思我们的在 PyFlink 上的流批一体的架构。</p>
<h2 id="0x03-流批一体的架构"><a href="#0x03-流批一体的架构" class="headerlink" title="0x03    流批一体的架构"></a>0x03    流批一体的架构</h2><h3 id="架构"><a href="#架构" class="headerlink" title="架构"></a>架构</h3><p>首先我们要梳理数据，要清楚数据从哪里来。在以 spark 为主的时期，数据是定期从数据源加载（增量）数据，通过一定的转换逻辑，然后写入目的地，由于数据量和业务需要，延迟通常在小时级别，而实时的话，需要尽可能短的延迟，因此将数据源进行了分类，整体分成了几部分，一部分是传统的数据我们存放在 MySQL 持久化做保存，这部分之后可以直接作为批处理的计算，也可以导入 hive，做进一步的计算。实时的部分，实际上是有很多思路，一种方式是通过 MySQL 的 binlog 做解析，还有就是 MySQL 的 cdc 功能，在多方考量下，最后我们选择了 Kafka，不仅是因为其是优秀的分布式流式平台，而且团队也有对其的技术沉淀。</p>
<p>并且实际上在本地开发的时候，安装 Kafka 也比较方便，只需要<code> brew install kafka</code>，而且通过 conduktor 客户端，也可以方便的看到每个 Topic 的情况。于是就对现有的 Parser 进行改造，使其支持 Kafka，在当收到新的区块时，会立即向 Kafka 发送一个消息，然后进行处理。</p>
<p>大概是在 2018 年的时候，团队将整体的业务迁移到了 kubernetes 上，在业务不断发展的过程中，其对开发和运维上来说，减轻了很多负担，所以建议有一定规模的业务，最好是迁移到 kubernetes，其对成本的优化，DevOps，以及高可用的支持，都是其他平台和传统方式无法比拟的。</p>
<p>在开发作业的过程中，我们在尽可能的使用 Flink SQL，同时结合一些 Java 、Python 的 UDF，UDAF，UDTF。每个作业通过初始化类似于以下的语句，形成一定的模式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">self.source_ddl &#x3D; &#39;&#39;&#39;</span><br><span class="line">    CREATE TABLE SourceTable (xxx int) WITH </span><br><span class="line">&#39;&#39;&#39;</span><br><span class="line">self.sink_ddl &#x3D; &#39;&#39;&#39;</span><br><span class="line">    CREATE TABLE SinkTable (xxx int) WITH </span><br><span class="line">&#39;&#39;&#39;</span><br><span class="line">self.transform_ddl &#x3D; &#39;&#39;&#39;</span><br><span class="line">    INSERT INTO SinkTable</span><br><span class="line">    SELECT udf(xxx)</span><br><span class="line">    FROM SourceTable</span><br><span class="line">    GROUP BY FROM_UNIXTIME(&#96;timestamp&#96;, &#39;yyyyMMdd&#39;)</span><br><span class="line">&#39;&#39;&#39;</span><br></pre></td></tr></table></figure>

<p>在未来的话，会针对性地将数据进行分层，按照业界通用的 ODS、DWD、DWS、ADS，分出原始层，明细层和汇总层，进一步做好数据的治理。</p>
<h3 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h3><p>最终我们团队基于 PyFlink 开发快速地完成了已有的任务，部分是批处理作业，处理过去几天的数据，部分是实时作业，根据 Kafka 的消息进行消费，目前还算比较稳定。</p>
<p>部署时选择了kubernetes，具体下面会进行分享。在 k8s 部署了 jobmanager 和 taskmanager，并且使用 kubernetes 的 job 功能作为批处理作业的部署，之后考虑接入一些监控平台，比如 Prometheus 之类的。</p>
<p>在成本方面，由于是使用的 kubernetes 集群，因此在机器上只有扩展主机的成本，在这种方式上，成本要比传统的 yarn 部署方式要低，并且之后 kuberntes 会支持原生部署，在扩展 jobmanager 和 taskmanager 上面会更加方便。</p>
<h2 id="0x04-Zeppelin，PyFlink-on-k8s-等实践"><a href="#0x04-Zeppelin，PyFlink-on-k8s-等实践" class="headerlink" title="0x04    Zeppelin，PyFlink on k8s 等实践"></a>0x04    Zeppelin，PyFlink on k8s 等实践</h2><p>Zeppelin 是我们用来进行数据探索和逻辑验证，有些数据在本地不是真实数据，利用 Zeppelin 连接实际的链上数据，进行计算的逻辑验证，当验证完成后，便可转换成生产需要的代码进行部署。</p>
<p><img src="https://s1.ax1x.com/2020/09/16/w2oAje.png" alt="w2oAje.png"></p>
<p>一、kubernetes 上搭建 PyFlink 和 Zeppelin</p>
<ol>
<li>整理后的部署 Demo 在 github，可以参阅<a target="_blank" rel="noopener" href="https://github.com/liuyangovo/Flink-Zeppelin-Demo">这里</a></li>
<li>关于配置文件修改</li>
</ol>
<p>1). flink-conf.yaml</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">taskmanager.numberOfTaskSlots: 10</span><br></pre></td></tr></table></figure>

<p>这里可以调整 Taskmanager 可运行的的 job 的数量</p>
<p>2). zeppelin-site.xml</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cp conf&#x2F;zeppelin-site.xml.template conf&#x2F;zeppelin-site.xml; \</span><br><span class="line">sed -i &#39;s#&lt;value&gt;127.0.0.1&lt;&#x2F;value&gt;#&lt;value&gt;0.0.0.0&lt;&#x2F;value&gt;#g&#39; conf&#x2F;zeppelin-site.xml; \</span><br><span class="line">sed -i &#39;s#&lt;value&gt;auto&lt;&#x2F;value&gt;#&lt;value&gt;local&lt;&#x2F;value&gt;#g&#39; conf&#x2F;zeppelin-site.xml</span><br></pre></td></tr></table></figure>

<ul>
<li>修改请求来源为 0.0.0.0，如果是线上环境，建议开启白名单，加上 auth 认证。</li>
<li>修改 interpreter 的启动模式为 local，auto 会导致在集群启动时，以 k8s 的模式启动，目前 k8s 模式只支持 Spark, local 模式可以理解为，Zeppelin 将在本地启动一个连接 Flink 的 interpreter 进程。</li>
<li>Zeppelin 和在本地提交 Flink 作业类似，也需要 PyFlink 的基础环境，所以需要将 Flink 对应版本的 jar 包放入镜像内。</li>
</ul>
<ol start="3">
<li>Zeppelin 访问代理</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nginx.ingress.kubernetes.io&#x2F;configuration-snippet: |</span><br><span class="line">    proxy_set_header Upgrade &quot;websocket&quot;;</span><br><span class="line">    proxy_set_header Connection &quot;Upgrade&quot;;</span><br></pre></td></tr></table></figure>

<p>Zeppelin 在浏览器需要和 server 端建立 socket 连接，需要在 ingress 添加 websocket 配置。</p>
<ol start="4">
<li>Flink 和 Zeppelin 数据持久化</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- mountPath: &#x2F;opt&#x2F;flink&#x2F;lib</span><br><span class="line">- mountPath: &#x2F;zeppelin&#x2F;notebook&#x2F;</span><br></pre></td></tr></table></figure>

<ul>
<li>对 Flink 的 lib 做持久化的目的是需要 jar 包时可以直接进入 pod 下载，而无需更换镜像。</li>
<li>Zeppelin 的任务代码会存放在 notebook 目录下，保存编写好的代码。</li>
</ul>
<ol start="5">
<li>PyFlink 本地提交 job</li>
</ol>
<p>1). 本地安装 PyFlink</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pip3 install apache-flink&#x3D;&#x3D;1.11.1</span><br></pre></td></tr></table></figure>

<p>2). 测试 demo</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">def word_count():</span><br><span class="line">    env &#x3D; StreamExecutionEnvironment.get_execution_environment()</span><br><span class="line">    t_env &#x3D; StreamTableEnvironment.create(</span><br><span class="line">        env,</span><br><span class="line">        environment_settings&#x3D;EnvironmentSettings.new_instance().use_blink_planner().build()</span><br><span class="line">    )</span><br><span class="line">    sink_ddl &#x3D; &quot;&quot;&quot;</span><br><span class="line">        create table Results (word VARCHAR, &#96;count&#96; BIGINT) with ( &#39;connector&#39; &#x3D; &#39;print&#39;)</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">    t_env.sql_update(sink_ddl)</span><br><span class="line">    elements &#x3D; [(word, 1) for word in content.split(&quot; &quot;)]</span><br><span class="line">    # 这里也可以通过 Flink SQL</span><br><span class="line">    t_env.from_elements(elements, [&quot;word&quot;, &quot;count&quot;]) \</span><br><span class="line">        .group_by(&quot;word&quot;) \</span><br><span class="line">        .select(&quot;word, count(1) as count&quot;) \</span><br><span class="line">        .insert_into(&quot;Results&quot;)</span><br><span class="line">    t_env.execute(&quot;word_count&quot;)</span><br><span class="line">if __name__ &#x3D;&#x3D; &#39;__main__&#39;:</span><br><span class="line">    logging.basicConfig(stream&#x3D;sys.stdout, level&#x3D;logging.INFO, format&#x3D;&quot;%(message)s&quot;)</span><br><span class="line">    word_count()</span><br></pre></td></tr></table></figure>

<p>或者是实时处理的 Demo：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">def handle_kafka_message():</span><br><span class="line">    s_env &#x3D; StreamExecutionEnvironment.get_execution_environment()</span><br><span class="line">    # s_env.set_stream_time_characteristic(TimeCharacteristic.EventTime)</span><br><span class="line">    s_env.set_parallelism(1)</span><br><span class="line">    st_env &#x3D; StreamTableEnvironment \</span><br><span class="line">        .create(s_env, environment_settings&#x3D;EnvironmentSettings</span><br><span class="line">                .new_instance()</span><br><span class="line">                .in_streaming_mode()</span><br><span class="line">                .use_blink_planner().build())</span><br><span class="line">    source_ddl &#x3D; &#39;&#39;&#39;</span><br><span class="line">      CREATE TABLE SourceTable (</span><br><span class="line">      	word string</span><br><span class="line">      ) WITH (</span><br><span class="line">        &#39;connector.type&#39; &#x3D; &#39;kafka&#39;,</span><br><span class="line">        &#39;connector.version&#39; &#x3D; &#39;universal&#39;,</span><br><span class="line">        &#39;connector.topic&#39; &#x3D; &#39;Topic&#39;,</span><br><span class="line">        &#39;connector.properties.bootstrap.servers&#39; &#x3D; &#39;localhost:9092&#39;,</span><br><span class="line">        &#39;connector.properties.zookeeper.connect&#39; &#x3D; &#39;localhost:2121&#39;,</span><br><span class="line">        &#39;format.type&#39; &#x3D; &#39;json&#39;,</span><br><span class="line">        &#39;format.derive-schema&#39; &#x3D; &#39;true&#39;</span><br><span class="line">      )</span><br><span class="line">    &#39;&#39;&#39;</span><br><span class="line">    sink_ddl &#x3D; &quot;&quot;&quot;</span><br><span class="line">        create table Results (word VARCHAR) with (&#39;connector&#39; &#x3D; &#39;print&#39;)</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">    st_env.sql_update(sink_ddl)</span><br><span class="line">    st_env.sql_update(source_ddl)</span><br><span class="line">    st_env.from_path(&quot;source&quot;).insert_into(&quot;sink&quot;)</span><br><span class="line">    st_env.execute(&quot;KafkaTest&quot;)</span><br><span class="line">    </span><br><span class="line">if __name__ &#x3D;&#x3D; &#39;__main__&#39;:</span><br><span class="line">    handle_kafka_message()</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>本地测试 Flink 提交 job</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ flink run -m localhost:8081 -py word_count.py</span><br><span class="line">python&#x2F;table&#x2F;batch&#x2F;word_count.py</span><br><span class="line">Job has been submitted with JobID 0a31b61c2f974bcc3f344f57829fc5d5</span><br><span class="line">Program execution finished</span><br><span class="line">Job with JobID 0a31b61c2f974bcc3f344f57829fc5d5 has finished.</span><br><span class="line">Job Runtime: 741 ms</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>PyFlink 本地提交 Python Job，这里将相关代码进行了打包。</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ zip -r flinkdemo.zip .&#x2F;*</span><br><span class="line">$ flink run -m localhost:8081 -pyfs flinkdemo.zip -pym main</span><br></pre></td></tr></table></figure>

<ol start="5">
<li>Kubernetes 通过集群本身的 Job 功能来提交 Job，之后会做自研一些 UI 后台界面做作业管理与监控。</li>
</ol>
<h2 id="0x05-在区块链领域实践"><a href="#0x05-在区块链领域实践" class="headerlink" title="0x05    在区块链领域实践"></a>0x05    在区块链领域实践</h2><p>随着区块链技术的越来越成熟，应用越来越多，行业标准化、规范化的趋势也开始显现，也越来越依赖于云计算、大数据，毕竟是数字经济的产物。BTC.com 也在扎根于区块链技术基础设施，为各类公司各类应用提供数据和业务上的支持。</p>
<p>近些年，有个词火遍了 IT 业界，中台，不管是大公司还是创业公司，都喜欢扯上这个概念，号称自己业务中台，数据中台等。我们的理解中，中台是一种整合各方面资源的能力，从传统的单兵作战，到提升武器装备后勤保障，提升作战能力。在数据上打破数据孤岛，在需求快速变化的前台和日趋稳定的后台中取得平衡。而中台更重要的是服务，最终还是要回馈到客户，回馈到合作伙伴。</p>
<p>在区块链领域，BTC.com 有着深厚的行业技术积累，可以提供各方面数据化的能力。比如在利用机器学习进行链上数据的预估，预估 eth 的 gas price，还有最佳手续费等，利用 keras 深度学习的能力，进行一些回归计算，在之后也会将 Flink、机器学习和区块链结合起来，对外提供更多预测类和规范化分类的数据样本，之前是在用定时任务不断训练模型，与 Flink 结合之后，会更加实时。在这方面，以后也会提供更多的课题，比如币价与 Defi，舆情，市场等的关系，区块链地址与交易的标注和分类。甚至于将机器学习训练的模型，放于 IPFS 网络中，通过去中心化的代币进行训练，提供方便调用样本和模型的能力。</p>
<p>在目前，BTC.com 推出了一些通过数据挖掘实现的能力，包括交易推送、OLAP 链上分析报表等，改善和提升相关行业和开发者实际的体验。我们在各种链上都有监控节点，监控各区块链网络的可用性、去中心化程度，监控智能合约。在接入一些联盟链、隐私加密货币，可以为联盟链、隐私加密货币提供这方面的数据能力。BTC.com 将为区块链产业生态发展做出更多努力，以科技公司的本质，以技术发展为第一驱动力，以市场和客户为导向，开发创新和融合应用，做好基础设施。</p>
<h2 id="0x06-展望-总结"><a href="#0x06-展望-总结" class="headerlink" title="0x06    展望 / 总结"></a>0x06    展望 / 总结</h2><p>从实时计算的趋势，到流批一体的架构，通过对 PyFlink 和 Flink 的学习，稳定在线上运行了多种作业任务，对接了实际业务需求。并且搭建了 Zeppelin 平台，使得业务开发上更加方便。在计算上尽可能地依赖 SQL，方便各方面的集成与调试。</p>
<p>在社区方面，PyFlink 也是没有令我们失望的，较快的响应能力，不断完善的文档。在 <a target="_blank" rel="noopener" href="https://cwiki.apache.org/confluence/display/FLINK/Flink+Improvement+Proposals">Confluence</a> 上也可以看到一些 Flink Improvement Proposals，其中也有一些是 PyFlink 相关的，在不远的将来，还会支持 Pandas UDAF，DataStream API，ML API，也期望在之后可以支持 Joblistener，总之，在这里也非常感谢相关团队。</p>
<p>未来的展望，总结起来就是，通过业务实现数据的价值化。而数据中台的终局，是将数据变现。</p>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><p><a target="_blank" rel="noopener" href="https://www.infoq.cn/article/sKKHyb_jetRuDKXfqTwU">唯品会实时计算平台的演进之路</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/87368233">双11快到了，你的实时运营分析准备好了吗？</a></p>
<p><a target="_blank" rel="noopener" href="https://www.donews.com/article/detail/4787/23860.html">打造区块链王牌浏览器：欧科云链以 OKLink 打破多币种数据壁垒</a></p>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1483361">你公司到底需不需要引入实时计算引擎？</a></p>
</div><div class="article-licensing box"><div class="licensing-title"><p>PyFlink 流批一体以及 BTC.com 在区块链领域的专业实践</p><p><a href="https://dbqf.xyz/202008-pyfink-btccom-blockchain.html">https://dbqf.xyz/202008-pyfink-btccom-blockchain.html</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>admin</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2020-09-08</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2020-09-08</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/btc-com/">btc.com</a><a class="link-muted mr-2" rel="tag" href="/tags/pyflink/">pyflink</a></div><div class="addthis_inline_share_toolbox"></div><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-6038abc057217892" defer></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>Alipay</span><span class="qrcode"><img src="https://dubuqingfeng.oss-cn-hongkong.aliyuncs.com/blog/common/blog_ali_pay.png" alt="Alipay"></span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>Wechat</span><span class="qrcode"><img src="https://dubuqingfeng.oss-cn-hongkong.aliyuncs.com/blog/common/blog_wechat_pay.png" alt="Wechat"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/202012-flink-realtime-olap.html"><i class="level-item fas fa-chevron-left"></i><span class="level-item">实时 OLAP， 从 0 到 1</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/201704-personal-knowledge-management.html"><span class="level-item">浅谈自己的知识管理，即自我知识体系</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><script src="https://utteranc.es/client.js" repo="dubuqingfeng/tech-blog" issue-term="pathname" label="some-issue-label" theme="github-light" crossorigin="anonymous" async></script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://dubuqingfeng.oss-cn-hongkong.aliyuncs.com/blog/common/github-icon-url.jpeg" alt="独步清风"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">独步清风</p><p class="is-size-6 is-block">dubuqingfeng</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Beijing</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">32</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">19</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">50</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/dubuqingfeng" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/dubuqingfeng"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><ul class="menu-list"><ul class="menu-list"><li><a class="level is-mobile" href="#概要："><span class="level-left"><span class="level-item">1.1.1</span><span class="level-item">概要：</span></span></a></li></ul></ul><li><a class="level is-mobile" href="#0x01-TOC"><span class="level-left"><span class="level-item">2</span><span class="level-item">0x01    TOC</span></span></a></li><li><a class="level is-mobile" href="#0x02-困惑-•-描述-•-思考-•-行动"><span class="level-left"><span class="level-item">3</span><span class="level-item">0x02    困惑 • 描述 • 思考 • 行动</span></span></a></li><li><a class="level is-mobile" href="#0x03-流批一体的架构"><span class="level-left"><span class="level-item">4</span><span class="level-item">0x03    流批一体的架构</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#架构"><span class="level-left"><span class="level-item">4.1</span><span class="level-item">架构</span></span></a></li><li><a class="level is-mobile" href="#效果"><span class="level-left"><span class="level-item">4.2</span><span class="level-item">效果</span></span></a></li></ul></li><li><a class="level is-mobile" href="#0x04-Zeppelin，PyFlink-on-k8s-等实践"><span class="level-left"><span class="level-item">5</span><span class="level-item">0x04    Zeppelin，PyFlink on k8s 等实践</span></span></a></li><li><a class="level is-mobile" href="#0x05-在区块链领域实践"><span class="level-left"><span class="level-item">6</span><span class="level-item">0x05    在区块链领域实践</span></span></a></li><li><a class="level is-mobile" href="#0x06-展望-总结"><span class="level-left"><span class="level-item">7</span><span class="level-item">0x06    展望 / 总结</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#参考资料"><span class="level-left"><span class="level-item">7.1</span><span class="level-item">参考资料</span></span></a></li></ul></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://xiaoye.me" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Life</span></span><span class="level-right"><span class="level-item tag">xiaoye.me</span></span></a></li><li><a class="level is-mobile" href="http://sunu11.com/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Sunu11</span></span><span class="level-right"><span class="level-item tag">sunu11.com</span></span></a></li><li><a class="level is-mobile" href="https://blog.csdn.net/ifkirin" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">ifkirin</span></span><span class="level-right"><span class="level-item tag">blog.csdn.net</span></span></a></li></ul></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/2014/"><span class="level-start"><span class="level-item">2014</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Android/"><span class="level-start"><span class="level-item">Android</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Android%E5%AE%89%E5%85%A8/"><span class="level-start"><span class="level-item">Android安全</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/Bugtags/"><span class="level-start"><span class="level-item">Bugtags</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/DevOps/"><span class="level-start"><span class="level-item">DevOps</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Docker/"><span class="level-start"><span class="level-item">Docker</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Web%E5%AE%89%E5%85%A8/"><span class="level-start"><span class="level-item">Web安全</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/bitcoin/"><span class="level-start"><span class="level-item">bitcoin</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/chromebook/"><span class="level-start"><span class="level-item">chromebook</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/flink/"><span class="level-start"><span class="level-item">flink</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/git/"><span class="level-start"><span class="level-item">git</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/linux/"><span class="level-start"><span class="level-item">linux</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/test/"><span class="level-start"><span class="level-item">test</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%8F%8D%E6%B1%87%E7%BC%96/"><span class="level-start"><span class="level-item">反汇编</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E7%94%B5%E5%AD%90%E8%AE%BE%E8%AE%A1/"><span class="level-start"><span class="level-item">电子设计</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%87%AA%E6%88%91%E7%AE%A1%E7%90%86/"><span class="level-start"><span class="level-item">自我管理</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%87%AA%E7%94%B1%E8%BD%AF%E4%BB%B6/"><span class="level-start"><span class="level-item">自由软件</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E9%80%86%E5%90%91%E5%8A%A0%E5%AF%86/"><span class="level-start"><span class="level-item">逆向加密</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E9%9A%8F%E7%AC%94/"><span class="level-start"><span class="level-item">随笔</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-12-19T03:42:00.000Z">2020-12-19</time></p><p class="title"><a href="/202012-bitcoin-schnorr-start.html">比特币新特性：Schnorr 签名系列：初识 Schnorr 签名</a></p><p class="categories"><a href="/categories/bitcoin/">bitcoin</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-12-15T02:42:00.000Z">2020-12-15</time></p><p class="title"><a href="/202012-flink-realtime-olap.html">实时 OLAP， 从 0 到 1</a></p><p class="categories"><a href="/categories/flink/">flink</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-09-08T03:42:00.000Z">2020-09-08</time></p><p class="title"><a href="/202008-pyfink-btccom-blockchain.html">PyFlink 流批一体以及 BTC.com 在区块链领域的专业实践</a></p><p class="categories"><a href="/categories/flink/">flink</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2017-01-28T03:42:00.000Z">2017-01-28</time></p><p class="title"><a href="/201704-personal-knowledge-management.html">浅谈自己的知识管理，即自我知识体系</a></p><p class="categories"><a href="/categories/%E8%87%AA%E6%88%91%E7%AE%A1%E7%90%86/">自我管理</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2016-10-24T07:42:00.000Z">2016-10-24</time></p><p class="title"><a href="/201610-devops-best-practices-sdl.html">DevOps 最佳实践之推进软件安全开发周期 SDL 建设</a></p><p class="categories"><a href="/categories/DevOps/">DevOps</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2020/12/"><span class="level-start"><span class="level-item">December 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/09/"><span class="level-start"><span class="level-item">September 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/01/"><span class="level-start"><span class="level-item">January 2017</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/10/"><span class="level-start"><span class="level-item">October 2016</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/07/"><span class="level-start"><span class="level-item">July 2016</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/06/"><span class="level-start"><span class="level-item">June 2016</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/05/"><span class="level-start"><span class="level-item">May 2016</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/03/"><span class="level-start"><span class="level-item">March 2016</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/12/"><span class="level-start"><span class="level-item">December 2015</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/08/"><span class="level-start"><span class="level-item">August 2015</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/06/"><span class="level-start"><span class="level-item">June 2015</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/05/"><span class="level-start"><span class="level-item">May 2015</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/04/"><span class="level-start"><span class="level-item">April 2015</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/03/"><span class="level-start"><span class="level-item">March 2015</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/02/"><span class="level-start"><span class="level-item">February 2015</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2014/11/"><span class="level-start"><span class="level-item">November 2014</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2014/10/"><span class="level-start"><span class="level-item">October 2014</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2014/07/"><span class="level-start"><span class="level-item">July 2014</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2014/06/"><span class="level-start"><span class="level-item">June 2014</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/2014/"><span class="tag">2014</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Android/"><span class="tag">Android</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Android-UI/"><span class="tag">Android UI</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Android%E5%AE%89%E5%85%A8/"><span class="tag">Android安全</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Bugtags/"><span class="tag">Bugtags</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Bug%E7%AE%A1%E7%90%86/"><span class="tag">Bug管理</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CNUTCon/"><span class="tag">CNUTCon</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Decompiler/"><span class="tag">Decompiler</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DevOps/"><span class="tag">DevOps</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Docker/"><span class="tag">Docker</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Log/"><span class="tag">Log</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/LogCat/"><span class="tag">LogCat</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PKM/"><span class="tag">PKM</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PreferenceFragment/"><span class="tag">PreferenceFragment</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SDL/"><span class="tag">SDL</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Web%E5%AE%89%E5%85%A8/"><span class="tag">Web安全</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/bitcoin/"><span class="tag">bitcoin</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/btc-com/"><span class="tag">btc.com</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/c/"><span class="tag">c</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/chromebook/"><span class="tag">chromebook</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/clickhouse/"><span class="tag">clickhouse</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/delphi%E5%8A%A0%E5%AF%86/"><span class="tag">delphi加密</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/drozer/"><span class="tag">drozer</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/findViewById/"><span class="tag">findViewById</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/flink/"><span class="tag">flink</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/fork/"><span class="tag">fork</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/git/"><span class="tag">git</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/github-pages/"><span class="tag">github pages</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/linux/"><span class="tag">linux</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mitm/"><span class="tag">mitm</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/olap/"><span class="tag">olap</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pelican/"><span class="tag">pelican</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pyflink/"><span class="tag">pyflink</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/schnorr/"><span class="tag">schnorr</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ubuntu/"><span class="tag">ubuntu</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vps/"><span class="tag">vps</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/xss/"><span class="tag">xss</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8F%8D%E5%B0%84/"><span class="tag">反射</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8F%8D%E6%B1%87%E7%BC%96/"><span class="tag">反汇编</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8F%8D%E7%BC%96%E8%AF%91/"><span class="tag">反编译</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AF%BC%E8%88%AA%E6%A0%8F/"><span class="tag">导航栏</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/"><span class="tag">年终总结</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%B3%A8%E8%A7%A3/"><span class="tag">注解</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%94%B5%E5%AD%90%E8%AE%BE%E8%AE%A1/"><span class="tag">电子设计</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%9F%A5%E8%AF%86%E7%AE%A1%E7%90%86/"><span class="tag">知识管理</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%A7%A3%E9%AD%94%E6%96%B9%E6%9C%BA%E5%99%A8%E4%BA%BA/"><span class="tag">解魔方机器人</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%BD%AF%E4%BB%B6%E6%BA%90/"><span class="tag">软件源</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%80%86%E5%90%91/"><span class="tag">逆向</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%9A%8F%E7%AC%94/"><span class="tag">随笔</span><span class="tag">2</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe for updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">独步清风&#039;s Blog</a><p class="is-size-7"><span>&copy; 2022 admin</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>